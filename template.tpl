___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Snapchat",
  "description": "The Snap Pixel is a piece of JavaScript code that helps Advertisers measure the cross-device impact of Campaigns. Advertisers will be able to see how many Snapchatters take action on their website(s)",
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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\u003d",
    "displayName": "Custom template created by PRETEC team",
    "id": "brand_dummy"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "help": "Pixel ID",
    "displayName": "Account ID",
    "simpleValueType": true,
    "name": "accountId",
    "type": "TEXT",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "SELECT",
    "name": "eventName",
    "displayName": "Event Name:",
    "selectItems": [
      {
        "value": "ACHIEVEMENT_UNLOCKED",
        "displayValue": "ACHIEVEMENT_UNLOCKED"
      },
      {
        "value": "AD_CLICK",
        "displayValue": "AD_CLICK"
      },
      {
        "value": "AD_VIEW",
        "displayValue": "AD_VIEW"
      },
      {
        "value": "ADD_BILLING",
        "displayValue": "ADD_BILLING"
      },
      {
        "value": "ADD_CART",
        "displayValue": "ADD_CART"
      },
      {
        "value": "ADD_TO_WISHLIST",
        "displayValue": "ADD_TO_WISHLIST"
      },
      {
        "value": "COMPLETE_TUTORIAL",
        "displayValue": "COMPLETE_TUTORIAL"
      },
      {
        "value": "CUSTOM_EVENT_1",
        "displayValue": "CUSTOM_EVENT_1"
      },
      {
        "value": "CUSTOM_EVENT_2",
        "displayValue": "CUSTOM_EVENT_2"
      },
      {
        "value": "CUSTOM_EVENT_3",
        "displayValue": "CUSTOM_EVENT_3"
      },
      {
        "value": "CUSTOM_EVENT_4",
        "displayValue": "CUSTOM_EVENT_4"
      },
      {
        "value": "CUSTOM_EVENT_5",
        "displayValue": "CUSTOM_EVENT_5"
      },
      {
        "value": "INVITE",
        "displayValue": "INVITE"
      },
      {
        "value": "LIST_VIEW",
        "displayValue": "LIST_VIEW"
      },
      {
        "value": "LOGIN",
        "displayValue": "LOGIN"
      },
      {
        "value": "PAGE_VIEW",
        "displayValue": "PAGE_VIEW"
      },
      {
        "value": "PURCHASE",
        "displayValue": "PURCHASE"
      },
      {
        "value": "RATE",
        "displayValue": "RATE"
      },
      {
        "value": "RESERVE",
        "displayValue": "RESERVE"
      },
      {
        "value": "SAVE",
        "displayValue": "SAVE"
      },
      {
        "value": "SEARCH",
        "displayValue": "SEARCH"
      },
      {
        "value": "SHARE",
        "displayValue": "SHARE"
      },
      {
        "value": "SIGN_UP",
        "displayValue": "SIGN_UP"
      },
      {
        "value": "SPENT_CREDITS",
        "displayValue": "SPENT_CREDITS"
      },
      {
        "value": "START_CHECKOUT",
        "displayValue": "START_CHECKOUT"
      },
      {
        "value": "START_TRIAL",
        "displayValue": "START_TRIAL"
      },
      {
        "value": "SUBSCRIBE",
        "displayValue": "SUBSCRIBE"
      },
      {
        "value": "VIEW_CONTENT",
        "displayValue": "VIEW_CONTENT"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": true,
    "defaultValue": "PAGE_VIEW",
    "subParams": [
      {
        "type": "LABEL",
        "name": "label1",
        "displayName": ""
      },
      {
        "type": "GROUP",
        "name": "group1",
        "displayName": "Event Parameters:",
        "groupStyle": "ZIPPY_OPEN",
        "subParams": [
          {
            "type": "SIMPLE_TABLE",
            "name": "eventParameters",
            "displayName": "",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Event Parameter:",
                "name": "parameter",
                "type": "SELECT",
                "selectItems": [
                  {
                    "value": "currency",
                    "displayValue": "currency"
                  },
                  {
                    "value": "description",
                    "displayValue": "description"
                  },
                  {
                    "value": "item_ids",
                    "displayValue": "item_ids"
                  },
                  {
                    "value": "number_items",
                    "displayValue": "number_items"
                  },
                  {
                    "value": "payment_info_available",
                    "displayValue": "payment_info_available"
                  },
                  {
                    "value": "price",
                    "displayValue": "price"
                  },
                  {
                    "value": "search_string",
                    "displayValue": "search_string"
                  },
                  {
                    "value": "sign_up_method",
                    "displayValue": "sign_up_method"
                  },
                  {
                    "value": "success",
                    "displayValue": "success"
                  },
                  {
                    "value": "transaction_id",
                    "displayValue": "transaction_ id"
                  }
                ],
                "isUnique": true,
                "valueValidators": []
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          }
        ]
      },
      {
        "type": "GROUP",
        "name": "group2",
        "displayName": "User Parameters:",
        "groupStyle": "ZIPPY_CLOSED",
        "subParams": [
          {
            "type": "SIMPLE_TABLE",
            "name": "userParameters",
            "displayName": "",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "User Parameters:",
                "name": "parameter",
                "type": "SELECT",
                "selectItems": [
                  {
                    "value": "user_email",
                    "displayValue": "user_email"
                  },
                  {
                    "value": "user_hashed_email",
                    "displayValue": "user_hashed_email"
                  },
                  {
                    "value": "user_hashed_phone_number",
                    "displayValue": "user_hashed_phone_number"
                  },
                  {
                    "value": "user_phone_number",
                    "displayValue": "user_phone_number"
                  }
                ],
                "isUnique": true
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ],
            "alwaysInSummary": true
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const injectScript = require('injectScript');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const setInWindow = require('setInWindow');
const createQueue = require('createQueue');
const aliasInWindow = require('aliasInWindow');
const makeTableMap = require('makeTableMap');

const eventName = data.eventName; 
const accountId = data.accountId;
const userParameters = data.userParameters;
const eventParameters = data.eventParameters;
const userParametersObj = userParameters ? makeTableMap(userParameters, 'parameter', 'value') : {};
const eventParametersObj = eventParameters ? makeTableMap(eventParameters, 'parameter', 'value') : {};

log('data =', data);

const getSnaptr = () => {
  let tr = copyFromWindow('tr');
  if (tr) {
    return tr;
  }
  setInWindow('tr', function() { 
    const trHandleReq = copyFromWindow('tr.handleRequest'); 
    if(trHandleReq) {
      callInWindow('tr.handleRequest.apply', tr, arguments); 
    }
    else {
      callInWindow('tr.queue.push', arguments);
    }
  });
  createQueue('tr.queue');
  aliasInWindow('snaptr', 'tr');
  tr = copyFromWindow('tr');
  tr('init', accountId, userParametersObj);
  return tr;
};

const snaptr = getSnaptr();

const onSuccess = () => {
  snaptr('track', eventName, eventParametersObj);
  data.gtmOnSuccess();
};

const trackingUrl = 'https://sc-static.net/scevent.min.js';
injectScript(trackingUrl, onSuccess, data.gtmOnFailure, 'snapPx');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://sc-static.net/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "snaptr"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "tr"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "tr.handleRequest"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "tr.handleRequest.apply"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "tr.queue.push"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "tr.queue"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Invoke gtmOnSuccess after successful injection
  code: "// Call runCode to run the template's code.\nmock('injectScript', (url, onSuccess,\
    \ gtmOnFailure) => {\n\tonSuccess();\n});\nrunCode(mockData);\n\n// Verify that\
    \ the tag finished successfully.\nassertApi('gtmOnSuccess').wasCalled();"
- name: Avoid calling other api methods if tr function is already available in window
  code: |2-

    mock('copyFromWindow', (name) => 'tr');
    // Call runCode to run the template's code.
    runCode();

    assertApi('setInWindow').wasNotCalled();
    assertApi('callInWindow').wasNotCalled();
    assertApi('createQueue').wasNotCalled();
    assertApi('aliasInWindow').wasNotCalled();
    assertApi('copyFromWindow').wasCalled(1); // copyFromWindow was only called in the mock above


___NOTES___

Desarrollado por: Alfonso, Brais, Txema


